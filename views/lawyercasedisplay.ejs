<%- include ("partials/header") %>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<style type="text/css">
    .h5{
	border: 2px solid grey;
	width: 250px;
	border-radius: 25px;
	padding-top: 10px;
	padding-bottom: 10px;
	margin-left: 420px;
	text-align: center;
	background-color: #e7f20a;
	color: #db0000;
}


.container{
	margin-top: 50px;
	border: 2px solid black;
	border-radius: 40px;
	width: 100%;
	height: auto;
	margin: auto center;
	padding-top: 30px;
	background-color: rgba(228,228,228,1);
	margin-bottom: 50px;
}

#hr{
	border: 2px solid black;
	border-radius: 15px;
	width: 965px;
	margin-bottom: 30px;
}

.l3{
	margin-left: 70px;
	margin-bottom: 40px;
}

.l2{
	margin-left: 180px;
	margin-bottom: 40px;
}

.l1{
	margin-top: 40px;
	margin-left: 70px;
	margin-bottom: 40px;
}

.l5{	
	margin-left: 70px;
	margin-bottom: 40px;
}

.l4{
	margin-left: 184px;
	margin-bottom: 40px;
}

.l6{
	margin-left: 184px;
	margin-bottom: 40px;
}

.l7{
	margin-top: 40px;
	margin-left: 70px;
	margin-bottom: 20px;
}

.l8{
	margin-left: 140px;
	margin-bottom: 20px;
}

.l9{
	margin-top: 30px;
	margin-left: 70px;
	margin-bottom: 45px;
}

.l11{
	margin-left: 70px;
	margin-bottom: 45px;
}

.l10{
	margin-left: 140px;
	margin-bottom: 45px;
}

.l12{
	margin-left: 140px;
	margin-bottom: 45px;
}

#desc{
	margin-top: 40px;
	margin-left: 70px;
	margin-bottom: 45px;
	margin-right: 70px;
}

#casename{
	margin-left: 140px;
	width: 200px;
}

#cliname{
	margin-left: 70px;
	width: 200px;
}

#casetype{
	margin-left: 140px;
	margin-right: 70px;
	width: 200px;
}

#lawname{
	margin-left: 59px;
	margin-right: 70px;
	width: 200px;
}

#casedate{
	margin-left: 135px;
	width: 200px;
}

#lawid{
	margin-left: 90px;
	margin-right: 70px;
	width: 200px;
}

#first{
	margin-left: 40px;
	width: 200px;
}

#next{
	margin-left: 40px;
	width: 200px;
}



#status{
	margin-left: 144px;
	width: 200px;
}

#court{
	margin-left: 120px; 
	width: 200px;
}

#judge{
	margin-left: 155px;
	width: 200px;
}

#report{
	margin-left: 145px;
	width: 200px;
}
</style>

<style>
	body {font-family: Arial, Helvetica, sans-serif;}
	* {box-sizing: border-box;}
	
	/* Button used to open the chat form - fixed at the bottom of the page */
	.open-button {
	  background-color: #555;
	  color: white;
	  padding: 16px 20px;
	  border: none;
	  cursor: pointer;
	  opacity: 0.8;
	  position: fixed;
	  bottom: 23px;
	  right: 28px;
	  width: 280px;
	}
	
	/* The popup chat - hidden by default */
	.chat-popup {
	  display: block;
	  position: fixed;
	  bottom: 0;
	  right: 15px;
	  border: 3px solid #f1f1f1;
	  z-index: 9;
	}
	
	/* Add styles to the form container */
	.form-container {
	  max-width: 300px;
	  padding: 10px;
	  background-color: white;
	}
	
	/* Full-width textarea */
	.form-container textarea {
	  width: 100%;
	  padding: 15px;
	  margin: 5px 0 22px 0;
	  border: none;
	  background: #f1f1f1;
	  resize: none;
	  min-height: 200px;
	}
	
	/* When the textarea gets focus, do something */
	.form-container textarea:focus {
	  background-color: #ddd;
	  outline: none;
	}
	
	/* Set a style for the submit/send button */
	.form-container .btn {
	  background-color: #4CAF50;
	  color: white;
	  padding: 16px 20px;
	  border: none;
	  cursor: pointer;
	  width: 100%;
	  margin-bottom:10px;
	  opacity: 0.8;
	}
	
	/* Add a red background color to the cancel button */
	.form-container .cancel {
	  background-color: red;
	}
	
	/* Add some hover effects to buttons */
	.form-container .btn:hover, .open-button:hover {
	  opacity: 1;
	}
	</style>
<div class="container">	
<div id="content">	
	<h5 class="h5">CASE DETAILS</h5>	
	<form>
		<div>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" class="l1">CASE</label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" id="casename"><%= caseNow.name%></label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" class="l2">TYPE</label>	
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" id="casetype"><%= caseNow.type%></label>		
		</div>

		<div>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" class="l3">CLIENT NAME</label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" id="cliname"><%= caseNow.author.name%></label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" class="l4">LAWYER NAME</label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" id="lawname"><%= caseNow.lawyer.name%></label>
		</div>

		<div>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" class="l5">DATE</label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" id="casedate"><%= caseNow.createdAt%></label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" class="l6">LAWYER ID</label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" id="lawid"><%= caseNow.lawyer.uid%></label>
			
		</div>

		<hr id="hr">

		<h5 class="h5">CASE DESCRIPTION</h5>

		<div style="word-wrap: break-word; text-align: justify;">		
			<label style="font-family: 'Poppins', sans-serif; font-size: 16px;" id="desc"><%= caseNow.description%></label>
		</div>

		<hr id="hr">

		<h5 class="h5">CASE STATUS</h5>

		<div>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" class="l7">FIRST HEARING DATE</label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" id="first"><%= caseNow.firsthearing%></label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" class="l8">NEXT HEARING DATE</label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" id="next"><%= caseNow.nexthearing%></label>			
		</div>

		<div>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" class="l9">STATUS</label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" id="status"><%= caseNow.status%></label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" class="l10">REPORT</label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" id="report"><%= caseNow.comment%></label>			
		</div>

		<div>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" class="l11">COURT NO</label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" id="court"><%= caseNow.courtno%></label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" class="l12">JUDGE</label>
			<label style="font-family: 'Crimson Text', serif; font-size: 16px;word-wrap: break-word; text-align: justify;" id="judge"><%= caseNow.judge%></label>			
		</div>
    </div>
        <button id="invoice" class="btn btn-secondary">Download Invoice</button>


	</form>
    </div>
    <script>
        var doc = new jsPDF();
        var specialElementHandlers = {
        '#editor': function (element, renderer) {
        return true;
    }
    };

    $('#invoice').click(function () {
    doc.fromHTML($('#content').html(), 15, 15, {
        'width': 170,
            'elementHandlers': specialElementHandlers
    });
    doc.save('sample-file.pdf');
});
	</script>
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script>

	<script>
  		
	</script>
  
	<body>
	
	<!-- <h2>Popup Chat Window</h2>
	<p>Click on the button at the bottom of this page to open the chat form.</p>
	<p>Note that the button and the form is fixed - they will always be positioned to the bottom of the browser window.</p> -->
	
	<button class="open-button" onclick="openForm()">Chat</button>
	
	<div class="chat-popup" id="myForm">
	  <form class="form-container">
		<h1>Chat</h1>
	
		<label id="rec" for="msg" style="height: 200px;">Message</label>
		<input type="text" placeholder="Type message.." name="msg" id="textar" required>
	
		<button id="sendmsg" type="submit" class="btn">Send</button>
		<button type="button" class="btn cancel" onclick="closeForm()">Close</button>
	  </form>
	</div>
	
	<script>


		var socket = io.connect();
		var userss = JSON.parse('<%-users %>');
		var law = JSON.parse('<%- lawyers%>');

		document.getElementById('sendmsg').addEventListener("click",function(){
			
			  
			socket.emit('LawyerBoom', { message : document.getElementById("textar").value , to :userss.id});
		
		});
          
        socket.on('Boom',function(data){
			if(data.to == law.uid){
				console.log("From JavaScript : " + data.message);
				document.getElementById("rec").innerHTML = data.message ;
		}
			});
	function openForm() {
	  document.getElementById("myForm").style.display = "block";

	}
	
	function closeForm() {
	  document.getElementById("myForm").style.display = "none";
	}
	</script>
	
	</body>
	</html>
	